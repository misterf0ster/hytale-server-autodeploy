<!DOCTYPE html>
<html>
<head>
    <title>Hytale Web Installer</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        #console {
            background-color: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Courier New', monospace;
            height: 500px;
            overflow-y: auto;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap; /* Сохраняет пробелы и переносы */
        }
        .log-info { color: #3498db; }
        .log-ok { color: #2ecc71; }
        .log-warn { color: #f1c40f; }
        .log-error { color: #e74c3c; }
    </style>
</head>
<body class="bg-dark text-white p-4">
    <div class="container">
        <h2 class="mb-4">Hytale Cloud Installer GUI</h2>
        
        <button id="startBtn" onclick="startInstallation()" class="btn btn-primary mb-3">Запустить установку</button>
        
        <div id="console">Нажмите кнопку, чтобы начать...</div>
    </div>

    <script>
        function startInstallation() {
            const consoleDiv = document.getElementById('console');
            const btn = document.getElementById('startBtn');
            
            btn.disabled = true;
            consoleDiv.innerHTML = "Подключение к процессу установки...\n";

            // Используем EventSource для получения потоковых данных
            const eventSource = new EventSource('/stream_install');

            eventSource.onmessage = function(e) {
                // Добавляем новую строку в консоль
                const newLine = document.createElement('span');
                
                // Простая раскраска логов (как в твоем Python скрипте)
                let text = e.data;
                if (text.includes('[INFO]')) newLine.className = 'log-info';
                if (text.includes('[OK]')) newLine.className = 'log-ok';
                if (text.includes('[WARN]')) newLine.className = 'log-warn';
                if (text.includes('[ERROR]')) newLine.className = 'log-error';

                newLine.textContent = text + '\n';
                consoleDiv.appendChild(newLine);
                
                // Автопрокрутка вниз
                consoleDiv.scrollTop = consoleDiv.scrollHeight;
            };

            eventSource.onerror = function() {
                eventSource.close();
                btn.disabled = false;
            };
        }
    </script>
</body>
</html>